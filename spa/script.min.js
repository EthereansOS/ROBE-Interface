"use strict";function _typeof(e){return e&&typeof Symbol!="undefined"&&e.constructor===Symbol?"symbol":typeof e}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,s){try{var o=t[i](s),u=o.value}catch(a){n(a);return}if(!o.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}!window.preloadedScripts && (window.preloadedScripts=[]);Array.prototype.push.apply(window.preloadedScripts,['spa/index/controller.jsx','spa/index/style.min.css','spa/index/view.jsx','spa/loader.jsx','spa/messages.jsx']);var IndexController=function(t){var n=this;n.view=t,n.viewers={editor:["text"]},n.split=function(t,n){return window.split(t,n)},n.mint=function(t,r,i){return window.mint(t,undefined,!1,function(e){n.view.tokenId&&(n.view.tokenId.value=e)},r,i)},n.loadContent=function(t){return window.loadContent(t,undefined)},n.loadContentMetadata=function(t){return window.loadContentMetadata(t)},n.onDownload=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,i,s,o,u;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:t=e.substring(5,e.indexOf(";")),i=Object.keys(window.context.supportedFileExtensions),f.t0=regeneratorRuntime.keys(i);case 3:if((f.t1=f.t0()).done){f.next=10;break}o=f.t1.value;if(window.context.supportedFileExtensions[i[o]]!=t){f.next=8;break}return s=i[o],f.abrupt("break",10);case 8:f.next=3;break;case 10:u=document.createElement("a"),u.download="robeFile."+s,u.href=e,u.target="_blank",document.body.appendChild(u),u.click(),setTimeout(function(){n.view.emit("loader/toggle",!1),n.view.emit("message","Your Robe Token can be now downloaded!","success"),document.body.removeChild(u)},300);case 17:case"end":return f.stop()}},r,this)}));return t}(),n.onView=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i,s,o,u,a,f,l,c,h;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:i=e.substring(5,e.indexOf(";")),s=Object.keys(window.context.supportedFileExtensions),o="sol",p.t0=regeneratorRuntime.keys(s);case 4:if((p.t1=p.t0()).done){p.next=11;break}u=p.t1.value;if(window.context.supportedFileExtensions[s[u]]!=i){p.next=9;break}return o=s[u],p.abrupt("break",11);case 9:p.next=4;break;case 11:a="Editor",f=Object.keys(n.viewers),p.t2=regeneratorRuntime.keys(f);case 14:if((p.t3=p.t2()).done){p.next=30;break}u=p.t3.value,l=f[u],c=n.viewers[l],p.t4=regeneratorRuntime.keys(c);case 19:if((p.t5=p.t4()).done){p.next=26;break}h=p.t5.value;if(i.indexOf(c[h])===-1){p.next=24;break}return a=l,p.abrupt("break",26);case 24:p.next=19;break;case 26:if(!a){p.next=28;break}return p.abrupt("break",30);case 28:p.next=14;break;case 30:if(a){p.next=33;break}return n.onDownload(e),p.abrupt("return");case 33:a=a[0].toUpperCase()+a.substring(1),n.view.setState({content:n["render"+a](e,i,o,t)},function(){n.view.emit("message",""),n.view.viewerContent.innerHTML=n.view.state.content;var e=function t(e){if(!e)return;for(var n in e){var r=e[n];r.onload&&r.onload.apply(r),t(r.children)}};e(n.view.viewerContent.children)});case 35:case"end":return p.stop()}},r,this)}));return t}(),n.renderEditor=function(t,r,i,s){var o=(new RegExp(window.base64Regex)).exec(t),u=o&&o.index===0?Base64.decode(t.substring(t.indexOf(","))):t;if(!u.split("\n").join("").split("\r").join("").split(" ").join("").split("	").join("").toLowerCase().indexOf("pragmasolidity")===-1)return n.onDownload(t);var a="view_"+(new Date).getTime(),f=function c(e,t){$.unsubscribe(a,c),monaco.editor.create(t,{language:i,value:u,readOnly:!0,theme:"vs-dark",minimap:{enabled:!1}})};$.subscribe(a,f);var l="<div onload=\"$.publish('"+a+'\', this);" style="width:800px;height:600px;border:1px solid grey;text-align:left;"></div>';return r.indexOf("html")!==-1&&(l='<div><iframe class="IFrame" src="'+t+'"></iframe><div>'+l+"</div>"),l}};var Index=React.createClass({displayName:"Index",getInitialState:function(){return{singleTokenLength:window.context.singleTokenLength}},requiredScripts:["assets/plugins/monaco.editor/monaco.editor.min.js","spa/loader.jsx","spa/messages.jsx"],onFileSelection:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(t);var n=t.currentTarget.files[0],r=this;this.setState({fileName:null,chunks:null},function(){var e;try{e=n.name.substring(n.name.lastIndexOf(".")+1).toLowerCase()}catch(t){}if(!e)return alert("Cannot retrieve file extension");var i;try{i=window.context.supportedFileExtensions[e]}catch(t){}if(!i)return alert("Unsupported file extension (."+e+")");r.emit("loader/toggle",!0);var s=new FileReader;s.addEventListener("load",function(){var e=s.result;e="data:"+i+e.substring(e.indexOf(";")),r.setState({fileName:n.name,code:e,chunks:r.controller.split(e,r.state.singleTokenLength)},function(){r.emit("loader/toggle",!1)})},!1),s.readAsDataURL(n)})},mint:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if(!this.state||!this.state.chunks||!this.state.chunks.length||this.state.chunks.length===0)return;this.emit("loader/toggle");var n=this;n.controller.mint(this.state.chunks,n.state.tokenContinue,n.state.tokenContinue!==undefined&&n.state.tokenContinue!==null&&n.state.metadata[0]||undefined).then(function(e){n.tokenId.value=e.toString(),n.emit("loader/toggle",!1),n.emit("message","Your Robe Token has been successfully minted!","success")}).catch(function(e){return n.emit("message",e.message||e,"error")})},load:function(t){t&&t.preventDefault&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=t.currentTarget&&t.currentTarget.innerHTML||t,r;try{r=parseInt(this.tokenId.value)}catch(t){}if(isNaN(r))return alert("You must specify a tokenId First");this.emit("loader/toggle"),this.emit("message","Loading Content...","info");var i=this;i.controller.loadContent(r).then(function(e){return i.emit("message","Performing "+n+"...","info"),i.controller["on"+n](e,r)}).catch(function(e){return i.emit("message",e.message||e,"error")})},onSingleTokenLength:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=parseInt(t.currentTarget.value)||window.context.singleTokenLength;this.singleTokenLengthTimeout&&clearTimeout(this.singleTokenLengthTimeout);var r=this;this.singleTokenLengthTimeout=setTimeout(function(){r.setState({singleTokenLength:n,chunks:r.state&&r.state.code&&r.controller.split(r.state.code,n)})},900)},onTokenContinue:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=parseInt(t.currentTarget.value);this.tokenContinueTimeout&&clearTimeout(this.tokenContinueTimeout);var r=this;this.tokenContinueTimeout=setTimeout(function(){if(isNaN(n))return r.setState({tokenContinue:null,metadata:null});r.emit("message","Loading token metadata...","info"),n>=0&&r.controller.loadContentMetadata(n).then(function(e){var t=e[2]?r.state&&r.state.singleTokenLength:e[1];r.setState({singleTokenLength:t,tokenContinue:n,metadata:e,chunks:r.state&&r.state.code&&r.controller.split(r.state.code,t)},function(){return r.emit("message","","info"),e[2]&&r.emit("message","This token has been already finalized","error")})})},900)},componentDidMount:function(){var t="";try{t=parseInt(window.location.search.toLowerCase().split("id=")[1])}catch(n){}this.tokenId.value=isNaN(t)?"":t.toString(),isNaN(t)||this.load("View")},renderTransactionsText:function(){if(!this.state||!this.state.chunks)return"";var t=this.state&&this.state.metadata&&this.state.metadata[0]||0;return" ("+(this.state.chunks.length-t)+"Txs)"},render:function(){var t=this,n="."+Object.keys(window.context.supportedFileExtensions).join(", .");return React.createElement("article",{className:"Main"},React.createElement(Loader,null),React.createElement(Messages,null),React.createElement("section",{className:"MainAll"},React.createElement("section",{className:"MainTitle"},React.createElement("img",{src:"./assets/img/ROBE.gif"}),React.createElement("h1",null,"ROBE"),React.createElement("h4",null,"An ERC-721 Improvement to Decentralize stuff"))),React.createElement("section",{className:"MainInsert"},React.createElement("h5",null,"With ROBE you can ",React.createElement("span",{className:"WOOW1"},"decentralize every file")," like code (HTML, JS, SVG...) or even images, documents, and more...",React.createElement("span",{className:"WOOW2"},"by storing it on-chain")," in a ",React.createElement("span",{className:"WOOW3"}," series of chained NFTs ")," and use it for your app or Dapp just download it when you need directly from the Ethereum chain"),React.createElement("section",{className:"MainActions"},React.createElement("section",{className:"MainActionsDe"},React.createElement("h6",null,"Decentralize Your File"),React.createElement("input",{type:"file",onChange:this.onFileSelection,accept:n}),React.createElement("button",{onClick:this.mint,disabled:!this.state||!this.state.chunks||!this.state.chunks.length||this.state.chunks.length===0},"Decentralize ",this.renderTransactionsText()),React.createElement("p",null,"Single Token Length"),React.createElement("input",{type:"number",min:"3",ref:function(n){return n&&(n.value=(t.state&t.state.singleTokenLength>=3?t.state.singleTokenLength:"")||window.context.singleTokenLength)},onChange:this.onSingleTokenLength,disabled:this.state&&this.state.tokenContinue!==undefined&&this.state.tokenContinue!==null&&this.state.tokenContinue>=0}),React.createElement("p",null,"File types supported:",React.createElement("br",null),n),React.createElement("p",null,"Continue for token"),React.createElement("input",{type:"number",min:"0",ref:function(n){return n&&(n.value=t.state&&t.state.tokenContinue>=0?t.state.tokenContinue:"")},onChange:this.onTokenContinue})),React.createElement("section",{className:"MainActionsLo"},React.createElement("h6",null,"Load an Existing File"),React.createElement("input",{type:"number",placeholder:"NFT ID",min:"0",ref:function(n){return t.tokenId=n}}),React.createElement("section",{className:"LoadedFile"},React.createElement("button",{onClick:this.load},"View"),React.createElement("button",{onClick:this.load},"Download"))))),this.state&&this.state.content&&React.createElement("section",{className:"MainEditor"},React.createElement("div",{className:"EditorView",ref:function(n){return t.viewerContent=n}})),React.createElement("section",{className:"MainDesc"},React.createElement("p",null,"ROBE is an Open-Source protocol to use ERC-721 (Non-Fungible Tokens) in a smart way, to decentralize things like coding files, images, Text and more..."),React.createElement("p",null,"This new standard is designed to improve the modern Dapps Decentralization, by revoming the the usage of Centralized Servers or IPFS for the front-end part and even for some files."),React.createElement("p",null,"This protocol allows developers to create chained NFTs for every code page or files they needs. Once published in the Blockchain, developers can call the code, decoded it using our decoder published on IPFS (Hoping to be introduced in Metamask or in browsers in the future) and use it for their Dapps or Apps."),React.createElement("p",null,"The most exciting things about this protocol is to start thinking about the Front-End as a future DAOs based decision, by the community and not by a well-known organization. In fact this protocol can adress a big point of failure in Dapps today, the possibility to shut down a Dapp by shutting down his centralized parts (DNS, Front-End). We hope to see a future of Dapps powered by ROBE and ENS to be totally unstoppable."),React.createElement("p",null,"ROBE is a base layer in our DFO Standard, a Flexible Standard to build DAO without the needs of a well known organization, more at ",React.createElement("a",{href:"https://dfohub.com"},"https://dfohub.com"))))}});var Loader=React.createClass({displayName:"Loader",getDefaultSubscriptions:function(){return{"loader/toggle":this.onToggle}},onToggle:function(t){this.setState({visible:t===!0||t===!1?t:this.state&&this.state.visible?!this.state.visible:!0})},render:function(){return React.createElement("div",{className:"MainLoader",style:{display:this.state&&this.state.visible?"block":"none"}},React.createElement("figure",null,React.createElement("img",{src:"./assets/img/RobeLoader.gif"})))}});var Messages=React.createClass({displayName:"Messages",getDefaultSubscriptions:function(){return{message:this.onMessage}},onMessage:function(t,n){var r=this;this.setState({message:t,className:n},function(){(!r.state.message||r.state.message.length===0||r.state.className==="error")&&r.emit("loader/toggle",!1)})},clear:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.onMessage()},render:function(){return React.createElement("div",{className:"MainMsg"+(this.state&&this.state.className?" MainMsg_"+this.state.className:""),style:{display:this.state&&this.state.message?"block":"none"}},this.state&&this.state.message&&typeof this.state.message=="string"&&React.createElement("p",null,this.state.message),this.state&&this.state.message&&typeof this.state.message!="string"&&this.state.message.map(function(e){return React.createElement("p",{key:e},e)}),React.createElement("button",{onClick:this.clear},"Close"))}});!window.preloadedScripts && (window.preloadedScripts=[]);Array.prototype.push.apply(window.preloadedScripts,['spa/index/controller.jsx','spa/index/style.min.css','spa/index/view.jsx','spa/loader.jsx','spa/messages.jsx']);